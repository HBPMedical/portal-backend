# Builder image
# Creates a portable environemnt to build this project.
# Do not push this image to Docker hub.
builder:
  build: Dockerfile.builder
  image: portal-backend-builder
  pre:
    - echo "Building portal backend builder"
  post:
    - docker run --rm -v $WORKSPACE:/opt/portal/ -v $HOME/.m2:/home/build/.m2/ hbpmip/portal-backend-build
    - echo "Finished building portal backend builder"
  test:
    - ./tests/test-build.sh

portal-backend:
  build: Dockerfile
  image: hbpmip/portal-backend
  pre:
    - echo "Building portal-backend"
  post:
    - echo "Finished building portal-backend"
  test:
    - ./tests/pre-test-run.sh
    - ./tests/test-run.sh
    - ./tests/post-test-run.sh
